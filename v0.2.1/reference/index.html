
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../getting_started/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>API reference - GEAS AI</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="GEAS AI" class="md-header__button md-logo" aria-label="GEAS AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GEAS AI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GEAS AI" class="md-nav__button md-logo" aria-label="GEAS AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GEAS AI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../WHITE_PAPER/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cli-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        CLI Commands
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.init" class="md-nav__link">
    <span class="md-ellipsis">
      
        init
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="init">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.init.init" class="md-nav__link">
    <span class="md-ellipsis">
      
        init
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        lifecycle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.archive" class="md-nav__link">
    <span class="md-ellipsis">
      
        archive
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.checkout" class="md-nav__link">
    <span class="md-ellipsis">
      
        checkout
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.delete" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.list_bolts" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_bolts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.new" class="md-nav__link">
    <span class="md-ellipsis">
      
        new
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.seal" class="md-nav__link">
    <span class="md-ellipsis">
      
        seal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="seal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.seal.seal" class="md-nav__link">
    <span class="md-ellipsis">
      
        seal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.status" class="md-nav__link">
    <span class="md-ellipsis">
      
        status
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="status">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.status.status" class="md-nav__link">
    <span class="md-ellipsis">
      
        status
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.verify" class="md-nav__link">
    <span class="md-ellipsis">
      
        verify
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="verify">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.verify.verify" class="md-nav__link">
    <span class="md-ellipsis">
      
        verify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.agents" class="md-nav__link">
    <span class="md-ellipsis">
      
        agents
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="agents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.agents.agents" class="md-nav__link">
    <span class="md-ellipsis">
      
        agents
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="identity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.add_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.list_identities" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_identities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.revoke_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        revoke_identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.show_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        show_identity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.prove" class="md-nav__link">
    <span class="md-ellipsis">
      
        prove
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="prove">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.prove.prove" class="md-nav__link">
    <span class="md-ellipsis">
      
        prove
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-logic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Logic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="identity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        IdentityManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IdentityManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager.add_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.KeyManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        KeyManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KeyManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.KeyManager.load_private_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_private_key
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.KeyNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      
        KeyNotFoundError
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.ledger" class="md-nav__link">
    <span class="md-ellipsis">
      
        ledger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ledger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerIntegrityError" class="md-nav__link">
    <span class="md-ellipsis">
      
        LedgerIntegrityError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        LedgerManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LedgerManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.append_event" class="md-nav__link">
    <span class="md-ellipsis">
      
        append_event
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.create_genesis_ledger" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_genesis_ledger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.load_lock" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_lock
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.save_lock" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_lock
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.verify_chain_integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        verify_chain_integrity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        workflow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.workflow.WorkflowManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        WorkflowManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkflowManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.workflow.WorkflowManager.load_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_workflow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.hashing" class="md-nav__link">
    <span class="md-ellipsis">
      
        hashing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hashing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.hashing.calculate_event_hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_event_hash
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.hashing.file_sha256" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_sha256
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.manifest" class="md-nav__link">
    <span class="md-ellipsis">
      
        manifest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="manifest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.manifest.calculate_merkle_root" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_merkle_root
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.manifest.generate_manifest" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_manifest
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.walker" class="md-nav__link">
    <span class="md-ellipsis">
      
        walker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="walker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.walker.load_gitignore_patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_gitignore_patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.walker.walk_source_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        walk_source_files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.testing.run_tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_tests
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Schemas
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.schemas.identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.schemas.ledger" class="md-nav__link">
    <span class="md-ellipsis">
      
        ledger
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.schemas.workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        workflow
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cli-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        CLI Commands
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.init" class="md-nav__link">
    <span class="md-ellipsis">
      
        init
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="init">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.init.init" class="md-nav__link">
    <span class="md-ellipsis">
      
        init
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        lifecycle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.archive" class="md-nav__link">
    <span class="md-ellipsis">
      
        archive
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.checkout" class="md-nav__link">
    <span class="md-ellipsis">
      
        checkout
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.delete" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.list_bolts" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_bolts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.lifecycle.new" class="md-nav__link">
    <span class="md-ellipsis">
      
        new
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.seal" class="md-nav__link">
    <span class="md-ellipsis">
      
        seal
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="seal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.seal.seal" class="md-nav__link">
    <span class="md-ellipsis">
      
        seal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.status" class="md-nav__link">
    <span class="md-ellipsis">
      
        status
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="status">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.status.status" class="md-nav__link">
    <span class="md-ellipsis">
      
        status
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.verify" class="md-nav__link">
    <span class="md-ellipsis">
      
        verify
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="verify">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.verify.verify" class="md-nav__link">
    <span class="md-ellipsis">
      
        verify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.agents" class="md-nav__link">
    <span class="md-ellipsis">
      
        agents
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="agents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.agents.agents" class="md-nav__link">
    <span class="md-ellipsis">
      
        agents
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="identity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.add_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.list_identities" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_identities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.revoke_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        revoke_identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.identity.show_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        show_identity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.commands.prove" class="md-nav__link">
    <span class="md-ellipsis">
      
        prove
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="prove">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.commands.prove.prove" class="md-nav__link">
    <span class="md-ellipsis">
      
        prove
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-logic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Logic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="identity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        IdentityManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IdentityManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager.add_identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.IdentityManager.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.KeyManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        KeyManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KeyManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.KeyManager.load_private_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_private_key
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.identity.KeyNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      
        KeyNotFoundError
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.ledger" class="md-nav__link">
    <span class="md-ellipsis">
      
        ledger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ledger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerIntegrityError" class="md-nav__link">
    <span class="md-ellipsis">
      
        LedgerIntegrityError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        LedgerManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LedgerManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.append_event" class="md-nav__link">
    <span class="md-ellipsis">
      
        append_event
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.create_genesis_ledger" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_genesis_ledger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.load_lock" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_lock
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.save_lock" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_lock
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.ledger.LedgerManager.verify_chain_integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        verify_chain_integrity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        workflow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.workflow.WorkflowManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        WorkflowManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkflowManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.workflow.WorkflowManager.load_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_workflow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.hashing" class="md-nav__link">
    <span class="md-ellipsis">
      
        hashing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hashing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.hashing.calculate_event_hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_event_hash
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.hashing.file_sha256" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_sha256
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.manifest" class="md-nav__link">
    <span class="md-ellipsis">
      
        manifest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="manifest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.manifest.calculate_merkle_root" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_merkle_root
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.manifest.generate_manifest" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_manifest
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.walker" class="md-nav__link">
    <span class="md-ellipsis">
      
        walker
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="walker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.walker.load_gitignore_patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_gitignore_patterns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.walker.walk_source_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        walk_source_files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.core.testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geas_ai.core.testing.run_tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_tests
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Schemas
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.schemas.identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        identity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.schemas.ledger" class="md-nav__link">
    <span class="md-ellipsis">
      
        ledger
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geas_ai.schemas.workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        workflow
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-reference">API Reference</h1>
<p>This section provides technical documentation for the internal GEAS-AI modules, automatically generated from the source code docstrings.</p>
<h2 id="cli-commands">CLI Commands</h2>


<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.init" class="doc doc-heading">
            <code>geas_ai.commands.init</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.init.init" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">init</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the GEAS governance layer in the current directory.</p>
<p>Creates the .geas/ directory structure and default configuration files.
This includes config/agents.yaml, config/models.yaml, and GEAS_MANIFESTO.md.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas init</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/init.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the GEAS governance layer in the current directory.</span>

<span class="sd">    Creates the .geas/ directory structure and default configuration files.</span>
<span class="sd">    This includes config/agents.yaml, config/models.yaml, and GEAS_MANIFESTO.md.</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas init</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_dir</span> <span class="o">=</span> <span class="s2">&quot;.geas&quot;</span>

    <span class="c1"># 1. Check Pre-condition</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">base_dir</span><span class="p">):</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="n">Panel</span><span class="p">(</span>
                <span class="s2">&quot;[bold red]Error:[/bold red] GEAS is already initialized in this directory.&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Initialization Failed&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 2. Create Directory Structure</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;bolts&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;archive&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># 3. Create Configuration Files</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="s2">&quot;agents.yaml&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">DEFAULT_AGENTS_YAML</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="s2">&quot;models.yaml&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">DEFAULT_MODELS_YAML</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="s2">&quot;identities.yaml&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">DEFAULT_IDENTITIES_YAML</span><span class="p">)</span>

        <span class="c1"># 4. Create Default Workflow</span>
        <span class="n">yaml</span> <span class="o">=</span> <span class="n">YAML</span><span class="p">()</span>
        <span class="n">yaml</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">workflow_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="s2">&quot;workflow.yaml&quot;</span><span class="p">)</span>

        <span class="c1"># Convert Pydantic model to dict, handling enums if necessary (mode=&#39;json&#39;)</span>
        <span class="c1"># However, we want clean YAML.</span>
        <span class="n">workflow_data</span> <span class="o">=</span> <span class="n">WorkflowManager</span><span class="o">.</span><span class="n">DEFAULT_WORKFLOW</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">workflow_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">workflow_data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

        <span class="c1"># 5. Create Manifesto</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;GEAS_MANIFESTO.md&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">MANIFESTO_CONTENT</span><span class="p">)</span>

        <span class="c1"># 6. Success Message</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="n">Panel</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold green]Success![/bold green] GEAS initialized at [blue]</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="si">}</span><span class="s2">[/blue]</span><span class="se">\n\n</span><span class="s2">Created:</span><span class="se">\n</span><span class="s2">- .geas/config/agents.yaml</span><span class="se">\n</span><span class="s2">- .geas/config/models.yaml</span><span class="se">\n</span><span class="s2">- .geas/config/identities.yaml</span><span class="se">\n</span><span class="s2">- .geas/config/workflow.yaml</span><span class="se">\n</span><span class="s2">- GEAS_MANIFESTO.md&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;GEAS Protocol&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[bold red]An error occurred during initialization:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.lifecycle" class="doc doc-heading">
            <code>geas_ai.commands.lifecycle</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.lifecycle.archive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">archive</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Archive a fully verified bolt.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas archive feature-completed</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/lifecycle.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">archive</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Archive a fully verified bolt.</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas archive feature-completed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">bolt</span> <span class="o">=</span> <span class="n">Bolt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">bolt</span><span class="o">.</span><span class="n">archive</span><span class="p">()</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[bold green]Success![/bold green] Bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; moved to archive.&quot;</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Verification failed</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Verification Failed:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Prompt for force archive</span>
        <span class="n">confirm</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Do you want to force archive &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; despite verification failure?&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Force archive logic manual override</span>
        <span class="c1"># We need a way to force archive in Bolt class or handle it here</span>
        <span class="c1"># Extending Bolt.archive to accept force param or manually moving</span>
        <span class="c1"># Let&#39;s manually move here since it&#39;s an edge case, or better, allow Bolt.archive(force=True)</span>
        <span class="c1"># But Bolt.archive currently doesn&#39;t accept force.</span>
        <span class="c1"># Let&#39;s update Bolt.archive? No, I committed that file.</span>
        <span class="c1"># Use low-level move.</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>

            <span class="n">archive_root</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_geas_root</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;archive&quot;</span>
            <span class="n">archive_root</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">target_path</span> <span class="o">=</span> <span class="n">archive_root</span> <span class="o">/</span> <span class="n">name</span>

            <span class="k">if</span> <span class="n">target_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists in archive.&quot;</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">bolt</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">target_path</span><span class="p">))</span>

            <span class="c1"># Update state</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="n">StateManager</span><span class="p">()</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">update_bolt_status</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;archived&quot;</span><span class="p">)</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">set_active_bolt</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_active_bolt</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold yellow]Forced Archive:[/bold yellow] Bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; moved to archive.&quot;</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">inner_e</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold red]Error during forced archive:[/bold red] </span><span class="si">{</span><span class="n">inner_e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.lifecycle.checkout" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkout</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Switch the current active context to a different bolt.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas checkout feature-login</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/lifecycle.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">checkout</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Switch the current active context to a different bolt.</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas checkout feature-login</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>

    <span class="n">manager</span> <span class="o">=</span> <span class="n">StateManager</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Verify it exists first</span>
        <span class="n">Bolt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">manager</span><span class="o">.</span><span class="n">set_active_bolt</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="n">Panel</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold green]Switched to bolt:[/bold green] [blue]</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">[/blue]&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;geas checkout&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error switching bolt:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.lifecycle.delete" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;--force&#39;</span><span class="p">,</span> <span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Force deletion without confirmation&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a bolt. State is cleaned up.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas delete feature-obsolete</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/lifecycle.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;--force&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Force deletion without confirmation&quot;</span>
    <span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a bolt. State is cleaned up.</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas delete feature-obsolete</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">manager</span> <span class="o">=</span> <span class="n">StateManager</span><span class="p">()</span>
        <span class="n">active_bolt</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_active_bolt</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">active_bolt</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Cannot delete the active bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. Switch context first.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Load implies existence check</span>
        <span class="n">bolt</span> <span class="o">=</span> <span class="n">Bolt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">confirm</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Are you sure you want to delete bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;?&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Abort</span><span class="p">()</span>

        <span class="n">bolt</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold green]Success:[/bold green] Bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; deleted.&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Bolt &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">typer</span><span class="o">.</span><span class="n">Abort</span><span class="p">:</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error deleting bolt:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.lifecycle.list_bolts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_bolts</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>List all bolts in the repository.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/lifecycle.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_bolts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all bolts in the repository.&quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>

    <span class="n">manager</span> <span class="o">=</span> <span class="n">StateManager</span><span class="p">()</span>
    <span class="n">bolts</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">list_bolts</span><span class="p">()</span>
    <span class="n">active_bolt</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_active_bolt</span><span class="p">()</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;GEAS Bolts&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Created At&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Active&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">bolts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">is_active</span> <span class="o">=</span> <span class="s2">&quot;[bold green]*[/bold green]&quot;</span> <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">active_bolt</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
            <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created_at&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">),</span>
            <span class="n">is_active</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.lifecycle.new" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Start a new GEAS Unit of Work (Bolt).</p>
<p>Creates .geas/bolts/<name>/ and updates state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bolt (slugified).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas new feature-login</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/lifecycle.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start a new GEAS Unit of Work (Bolt).</span>

<span class="sd">    Creates .geas/bolts/&lt;name&gt;/ and updates state.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the bolt (slugified).</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas new feature-login</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bolt</span> <span class="o">=</span> <span class="n">Bolt</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="n">Panel</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold green]Bolt Started![/bold green]</span><span class="se">\n\n</span><span class="s2">Workspace: [blue]</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">[/blue]</span><span class="se">\n</span><span class="s2">Context: [yellow]Updated[/yellow]</span><span class="se">\n</span><span class="s2">Ledger: [yellow]Initialized[/yellow]&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bolt: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Unexpected Error:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.seal" class="doc doc-heading">
            <code>geas_ai.commands.seal</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.seal.seal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seal</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Argument</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Target to seal [req, specs, plan, mrp, intent]&#39;</span><span class="p">),</span> <span class="n">identity_name</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;--identity&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Identity to sign with (required for intent)&#39;</span><span class="p">),</span> <span class="n">context</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;--context&#39;</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Context message for the event&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Cryptographically seal the current Bolt's artifacts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The artifact to seal.</p>
              </div>
            </td>
            <td>
                  <code><span title="typer.Argument">Argument</span>(..., help=&#39;Target to seal [req, specs, plan, mrp, intent]&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>identity_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The identity to sign with.</p>
              </div>
            </td>
            <td>
                  <code><span title="typer.Option">Option</span>(None, &#39;--identity&#39;, &#39;-i&#39;, help=&#39;Identity to sign with (required for intent)&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context message.</p>
              </div>
            </td>
            <td>
                  <code><span title="typer.Option">Option</span>(None, &#39;--context&#39;, &#39;-c&#39;, help=&#39;Context message for the event&#39;)</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas seal req
$ geas seal intent --identity arch-lead</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/seal.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">seal</span><span class="p">(</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Argument</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Target to seal [req, specs, plan, mrp, intent]&quot;</span>
    <span class="p">),</span>
    <span class="n">identity_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;--identity&quot;</span><span class="p">,</span> <span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Identity to sign with (required for intent)&quot;</span>
    <span class="p">),</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;--context&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Context message for the event&quot;</span>
    <span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cryptographically seal the current Bolt&#39;s artifacts.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: The artifact to seal.</span>
<span class="sd">        identity_name: The identity to sign with.</span>
<span class="sd">        context: Context message.</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas seal req</span>
<span class="sd">        $ geas seal intent --identity arch-lead</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>
    <span class="n">bolt_path</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_active_bolt_path</span><span class="p">()</span>

    <span class="c1"># Load Ledger</span>
    <span class="n">ledger_obj</span> <span class="o">=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">LedgerManager</span><span class="o">.</span><span class="n">load_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ledger_obj</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="s2">&quot;[bold red]Error:[/bold red] lock.json not found. Is this a valid bolt?&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Verify Chain Integrity before appending</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ledger</span><span class="o">.</span><span class="n">LedgerManager</span><span class="o">.</span><span class="n">verify_chain_integrity</span><span class="p">(</span><span class="n">ledger_obj</span><span class="p">):</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="s2">&quot;[bold red]CRITICAL:[/bold red] Ledger integrity check failed! The chain is broken.&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Dispatch Logic</span>
    <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="s2">&quot;intent&quot;</span><span class="p">:</span>
        <span class="n">_seal_intent</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">,</span> <span class="n">ledger_obj</span><span class="p">,</span> <span class="n">identity_name</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_seal_artifact</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">,</span> <span class="n">ledger_obj</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">identity_name</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

    <span class="c1"># Save Ledger</span>
    <span class="n">ledger</span><span class="o">.</span><span class="n">LedgerManager</span><span class="o">.</span><span class="n">save_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">,</span> <span class="n">ledger_obj</span><span class="p">)</span>

    <span class="c1"># ledger_obj.head_hash is Optional[str], but after seal it should be str.</span>
    <span class="n">head_hash_display</span> <span class="o">=</span> <span class="n">ledger_obj</span><span class="o">.</span><span class="n">head_hash</span><span class="p">[:</span><span class="mi">12</span><span class="p">]</span> <span class="k">if</span> <span class="n">ledger_obj</span><span class="o">.</span><span class="n">head_hash</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
        <span class="n">Panel</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[bold green]Sealed </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">![/bold green]</span><span class="se">\n</span><span class="s2">Head Hash: </span><span class="si">{</span><span class="n">head_hash_display</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;GEAS Seal&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.status" class="doc doc-heading">
            <code>geas_ai.commands.status</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.status.status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">status</span><span class="p">(</span><span class="n">bolt</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;--bolt&#39;</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the bolt to check status for&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Display the current seal status of a bolt.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas status
$ geas status -b feature-login</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/status.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">status</span><span class="p">(</span>
    <span class="n">bolt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;--bolt&quot;</span><span class="p">,</span> <span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of the bolt to check status for&quot;</span>
    <span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Display the current seal status of a bolt.</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas status</span>
<span class="sd">        $ geas status -b feature-login</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">bolt</span><span class="p">:</span>
        <span class="n">bolt_path</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_geas_root</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;bolts&quot;</span> <span class="o">/</span> <span class="n">bolt</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Bolt &#39;</span><span class="si">{</span><span class="n">bolt</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bolt_path</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_active_bolt_path</span><span class="p">()</span>

    <span class="c1"># Load Ledger</span>
    <span class="n">ledger</span> <span class="o">=</span> <span class="n">LedgerManager</span><span class="o">.</span><span class="n">load_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ledger</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[yellow]No ledger (lock.json) found or empty for bolt &#39;</span><span class="si">{</span><span class="n">bolt_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. Not Sealed.[/yellow]&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Display Header</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold]Bolt:[/bold] </span><span class="si">{</span><span class="n">ledger</span><span class="o">.</span><span class="n">bolt_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold]Created:[/bold] </span><span class="si">{</span><span class="n">ledger</span><span class="o">.</span><span class="n">created_at</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Determine State (Last Event)</span>
    <span class="n">last_event</span> <span class="o">=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">state_display</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[cyan]</span><span class="si">{</span><span class="n">last_event</span><span class="o">.</span><span class="n">action</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">[/cyan]&quot;</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold]Current State:[/bold] </span><span class="si">{</span><span class="n">state_display</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="c1"># Events Table</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Event History: </span><span class="si">{</span><span class="n">bolt_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Seq&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dim&quot;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Timestamp&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Action&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Signer&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
        <span class="n">signer</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">identity</span><span class="p">:</span>
            <span class="n">signer</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">identity</span><span class="o">.</span><span class="n">signer_id</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">sequence</span><span class="p">),</span>
            <span class="n">event</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">),</span>
            <span class="n">event</span><span class="o">.</span><span class="n">action</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">signer</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.verify" class="doc doc-heading">
            <code>geas_ai.commands.verify</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.verify.verify" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">verify</span><span class="p">(</span><span class="n">bolt</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;--bolt&#39;</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the bolt to verify&#39;</span><span class="p">),</span> <span class="n">check_content</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;--content&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Also verify sealed file contents match hashes&#39;</span><span class="p">),</span> <span class="n">json_output</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;--json&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output results as JSON&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Verify the cryptographic integrity and governance compliance of a bolt.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p>$ geas verify
$ geas verify --content
$ geas verify --json</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/verify.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">verify</span><span class="p">(</span>
    <span class="n">bolt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;--bolt&quot;</span><span class="p">,</span> <span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of the bolt to verify&quot;</span>
    <span class="p">),</span>
    <span class="n">check_content</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;--content&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Also verify sealed file contents match hashes&quot;</span>
    <span class="p">),</span>
    <span class="n">json_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;--json&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output results as JSON&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify the cryptographic integrity and governance compliance of a bolt.</span>

<span class="sd">    Usage:</span>
<span class="sd">        $ geas verify</span>
<span class="sd">        $ geas verify --content</span>
<span class="sd">        $ geas verify --json</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">bolt</span><span class="p">:</span>
        <span class="n">bolt_path</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_geas_root</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;bolts&quot;</span> <span class="o">/</span> <span class="n">bolt</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Bolt &#39;</span><span class="si">{</span><span class="n">bolt</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bolt_path</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_active_bolt_path</span><span class="p">()</span>

    <span class="c1"># 1. Load Data</span>
    <span class="n">ledger</span> <span class="o">=</span> <span class="n">LedgerManager</span><span class="o">.</span><span class="n">load_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ledger</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No lock.json found for bolt &#39;</span><span class="si">{</span><span class="n">bolt_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="k">if</span> <span class="n">json_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">msg</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Fail:[/bold red] </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">workflow_config</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">workflow_core</span><span class="o">.</span><span class="n">WorkflowManager</span><span class="o">.</span><span class="n">load_workflow</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># Loads default if missing</span>

    <span class="n">id_manager</span> <span class="o">=</span> <span class="n">IdentityManager</span><span class="p">()</span>
    <span class="n">identities</span> <span class="o">=</span> <span class="n">id_manager</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="c1"># 2. Run Validations</span>
    <span class="n">chain_res</span> <span class="o">=</span> <span class="n">verification</span><span class="o">.</span><span class="n">validate_chain_integrity</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
    <span class="n">sig_res</span> <span class="o">=</span> <span class="n">verification</span><span class="o">.</span><span class="n">validate_signatures</span><span class="p">(</span><span class="n">ledger</span><span class="p">,</span> <span class="n">identities</span><span class="p">)</span>
    <span class="n">flow_res</span> <span class="o">=</span> <span class="n">verification</span><span class="o">.</span><span class="n">validate_workflow_compliance</span><span class="p">(</span>
        <span class="n">ledger</span><span class="p">,</span> <span class="n">workflow_config</span><span class="p">,</span> <span class="n">identities</span>
    <span class="p">)</span>

    <span class="n">content_res</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">check_content</span><span class="p">:</span>
        <span class="n">content_res</span> <span class="o">=</span> <span class="n">verification</span><span class="o">.</span><span class="n">validate_content_integrity</span><span class="p">(</span><span class="n">ledger</span><span class="p">,</span> <span class="n">bolt_path</span><span class="p">)</span>

    <span class="c1"># 3. Aggregate Results</span>
    <span class="n">overall_valid</span> <span class="o">=</span> <span class="n">chain_res</span><span class="o">.</span><span class="n">valid</span> <span class="ow">and</span> <span class="n">sig_res</span><span class="o">.</span><span class="n">valid</span> <span class="ow">and</span> <span class="n">flow_res</span><span class="o">.</span><span class="n">valid</span>
    <span class="k">if</span> <span class="n">content_res</span><span class="p">:</span>
        <span class="n">overall_valid</span> <span class="o">=</span> <span class="n">overall_valid</span> <span class="ow">and</span> <span class="n">content_res</span><span class="o">.</span><span class="n">valid</span>

    <span class="c1"># 4. Output</span>
    <span class="k">if</span> <span class="n">json_output</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;bolt&quot;</span><span class="p">:</span> <span class="n">bolt_path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">overall_valid</span><span class="p">,</span>
            <span class="s2">&quot;chain&quot;</span><span class="p">:</span> <span class="n">chain_res</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">),</span>
            <span class="s2">&quot;signatures&quot;</span><span class="p">:</span> <span class="n">sig_res</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">),</span>
            <span class="s2">&quot;workflow&quot;</span><span class="p">:</span> <span class="n">flow_res</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">content_res</span><span class="p">:</span>
            <span class="n">output</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">content_res</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_print_report</span><span class="p">(</span>
            <span class="n">bolt_path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">overall_valid</span><span class="p">,</span> <span class="n">chain_res</span><span class="p">,</span> <span class="n">sig_res</span><span class="p">,</span> <span class="n">flow_res</span><span class="p">,</span> <span class="n">content_res</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">overall_valid</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.agents" class="doc doc-heading">
            <code>geas_ai.commands.agents</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.agents.agents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">agents</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>List the currently active agents configuration.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/agents.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">agents</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the currently active agents configuration.&quot;&quot;&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">ensure_geas_root</span><span class="p">()</span>

    <span class="c1"># Read from global .geas/config/agents.yaml</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_geas_root</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;config/agents.yaml&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Agent configuration not found at </span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Failed to parse agents.yaml: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="ow">or</span> <span class="s2">&quot;agents&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
            <span class="s2">&quot;[bold yellow]Warning:[/bold yellow] No agents defined in agents.yaml&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;GEAS Agents Roster (Global)&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Agent Name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">no_wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Role&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Goal&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

    <span class="c1"># Sort agents for consistent display</span>
    <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent_info</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;agents&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">agent_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
        <span class="n">goal</span> <span class="o">=</span> <span class="n">agent_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;goal&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">agent_name</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">goal</span><span class="p">)</span>

    <span class="n">utils</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.identity" class="doc doc-heading">
            <code>geas_ai.commands.identity</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.identity.add_identity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_identity</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="s1">&#39;-n&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Unique name for the identity.&#39;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="s1">&#39;--role&#39;</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Role: &#39;human&#39; or &#39;agent&#39;.&quot;</span><span class="p">),</span> <span class="n">persona</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;--persona&#39;</span><span class="p">,</span> <span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Persona (required if role is agent).&#39;</span><span class="p">),</span> <span class="n">model</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;--model&#39;</span><span class="p">,</span> <span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Model (required if role is agent).&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new identity and generate an Ed25519 keypair.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;add&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_identity</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="s2">&quot;--name&quot;</span><span class="p">,</span> <span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Unique name for the identity.&quot;</span><span class="p">),</span>
    <span class="n">role</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="s2">&quot;--role&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Role: &#39;human&#39; or &#39;agent&#39;.&quot;</span><span class="p">),</span>
    <span class="n">persona</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;--persona&quot;</span><span class="p">,</span> <span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Persona (required if role is agent).&quot;</span>
    <span class="p">),</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;--model&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Model (required if role is agent).&quot;</span>
    <span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new identity and generate an Ed25519 keypair.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Validate Role</span>
        <span class="k">if</span> <span class="n">role</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">IdentityRole</span><span class="p">]:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Invalid role &#39;</span><span class="si">{</span><span class="n">role</span><span class="si">}</span><span class="s2">&#39;. Must be &#39;human&#39; or &#39;agent&#39;.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">role_enum</span> <span class="o">=</span> <span class="n">IdentityRole</span><span class="p">(</span><span class="n">role</span><span class="p">)</span>

        <span class="c1"># Generate Keypair</span>
        <span class="n">private_bytes</span><span class="p">,</span> <span class="n">public_str</span> <span class="o">=</span> <span class="n">generate_keypair</span><span class="p">()</span>

        <span class="c1"># Save Private Key</span>
        <span class="n">keys_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.geas/keys&quot;</span><span class="p">))</span>
        <span class="n">keys_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">key_path</span> <span class="o">=</span> <span class="n">keys_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.key&quot;</span>

        <span class="k">if</span> <span class="n">key_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Key file already exists: </span><span class="si">{</span><span class="n">key_path</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Write private key (mode 0600)</span>
        <span class="c1"># Using os.open to ensure permissions from start</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">key_path</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">O_WRONLY</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_TRUNC</span><span class="p">,</span> <span class="mo">0o600</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">private_bytes</span><span class="p">)</span>

        <span class="c1"># Create Identity Object</span>
        <span class="n">identity</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role_enum</span><span class="p">,</span>
            <span class="n">persona</span><span class="o">=</span><span class="n">persona</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">active_key</span><span class="o">=</span><span class="n">public_str</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Add to Identity Store</span>
        <span class="n">manager</span> <span class="o">=</span> <span class="n">IdentityManager</span><span class="p">()</span>
        <span class="n">manager</span><span class="o">.</span><span class="n">add_identity</span><span class="p">(</span><span class="n">identity</span><span class="p">)</span>

        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold green]Success![/bold green] Identity &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; created.&quot;</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Private key saved to: [blue]</span><span class="si">{</span><span class="n">key_path</span><span class="si">}</span><span class="s2">[/blue]&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">role_enum</span> <span class="o">==</span> <span class="n">IdentityRole</span><span class="o">.</span><span class="n">AGENT</span><span class="p">:</span>
            <span class="c1"># We need to print the env var export for the user</span>
            <span class="c1"># Convert private key to base64 for env var</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

            <span class="n">b64_key</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">private_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">env_var</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;GEAS_KEY_</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[yellow]For Agent usage, set this environment variable:[/yellow]&quot;</span>
            <span class="p">)</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;export </span><span class="si">{</span><span class="n">env_var</span><span class="si">}</span><span class="s1">=&quot;</span><span class="si">{</span><span class="n">b64_key</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Validation Error:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Clean up key file if it was created</span>
        <span class="k">if</span> <span class="s2">&quot;key_path&quot;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">key_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key_path</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;key_path&quot;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">key_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key_path</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.identity.list_identities" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_identities</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>List all registered identities.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;list&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_identities</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List all registered identities.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">manager</span> <span class="o">=</span> <span class="n">IdentityManager</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error loading identities:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;GEAS Identities&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Role&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Persona&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Active Key (Fingerprint)&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">store</span><span class="o">.</span><span class="n">identities</span><span class="p">:</span>
        <span class="c1"># Simple truncation for &quot;fingerprint&quot; like display</span>
        <span class="n">key_display</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">i</span><span class="o">.</span><span class="n">active_key</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">16</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">active_key</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="k">else</span> <span class="s2">&quot;Invalid&quot;</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">persona</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">model</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">key_display</span>
        <span class="p">)</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.identity.revoke_identity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">revoke_identity</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">confirm</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;--yes&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Skip confirmation prompt.&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Revoke the current key for an identity and rotate to a new one.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;revoke&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">revoke_identity</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;--yes&quot;</span><span class="p">,</span> <span class="s2">&quot;-y&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Skip confirmation prompt.&quot;</span>
    <span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Revoke the current key for an identity and rotate to a new one.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">manager</span> <span class="o">=</span> <span class="n">IdentityManager</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error loading identities:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">identity</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">identity</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Identity &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">typer</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Are you sure you want to revoke and rotate the key for &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;?&quot;</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Abort</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 1. Archive current key</span>
        <span class="n">old_key</span> <span class="o">=</span> <span class="n">identity</span><span class="o">.</span><span class="n">active_key</span>
        <span class="n">identity</span><span class="o">.</span><span class="n">revoked_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_key</span><span class="p">)</span>

        <span class="c1"># 2. Generate new key</span>
        <span class="n">private_bytes</span><span class="p">,</span> <span class="n">public_str</span> <span class="o">=</span> <span class="n">generate_keypair</span><span class="p">()</span>
        <span class="n">identity</span><span class="o">.</span><span class="n">active_key</span> <span class="o">=</span> <span class="n">public_str</span>

        <span class="c1"># 3. Save new private key</span>
        <span class="n">keys_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.geas/keys&quot;</span><span class="p">))</span>
        <span class="n">keys_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">key_path</span> <span class="o">=</span> <span class="n">keys_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.key&quot;</span>

        <span class="c1"># Overwrite existing key file (rotation)</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">key_path</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">O_WRONLY</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_TRUNC</span><span class="p">,</span> <span class="mo">0o600</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">private_bytes</span><span class="p">)</span>

        <span class="c1"># 4. Save Identity Update</span>
        <span class="n">manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>

        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold green]Success![/bold green] Key for &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; rotated.&quot;</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New private key saved to: [blue]</span><span class="si">{</span><span class="n">key_path</span><span class="si">}</span><span class="s2">[/blue]&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">identity</span><span class="o">.</span><span class="n">role</span> <span class="o">==</span> <span class="n">IdentityRole</span><span class="o">.</span><span class="n">AGENT</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

            <span class="n">b64_key</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">private_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">env_var</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;GEAS_KEY_</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[yellow]For Agent usage, UPDATE this environment variable:[/yellow]&quot;</span>
            <span class="p">)</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;export </span><span class="si">{</span><span class="n">env_var</span><span class="si">}</span><span class="s1">=&quot;</span><span class="si">{</span><span class="n">b64_key</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error during revocation:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.identity.show_identity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_identity</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Show details of a specific identity.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">show_identity</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Show details of a specific identity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">manager</span> <span class="o">=</span> <span class="n">IdentityManager</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error loading identities:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">identity</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">identity</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Identity &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold cyan]Identity: </span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">[/bold cyan]&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Role: </span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">identity</span><span class="o">.</span><span class="n">persona</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Persona: </span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">persona</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">identity</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Model: </span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Created At: </span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">created_at</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Active Key: [yellow]</span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">active_key</span><span class="si">}</span><span class="s2">[/yellow]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">identity</span><span class="o">.</span><span class="n">revoked_keys</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Revoked Keys (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">identity</span><span class="o">.</span><span class="n">revoked_keys</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">identity</span><span class="o">.</span><span class="n">revoked_keys</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - [red]</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">[/red]&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;  Revoked Keys: None&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.commands.prove" class="doc doc-heading">
            <code>geas_ai.commands.prove</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.commands.prove.prove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prove</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="s1">&#39;src,tests&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma-separated directories to include in proof&#39;</span><span class="p">),</span> <span class="n">skip_tests</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Skip running tests (debugging only)&#39;</span><span class="p">),</span> <span class="n">command</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="s1">&#39;uv run pytest&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Command to run tests&#39;</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Test timeout in seconds&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a cryptographic proof of the codebase (Code Merkle Tree) and binds it to test results.
Does NOT seal the MRP (that happens after manual summary).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/commands/prove.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prove</span><span class="p">(</span>
    <span class="n">scope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
        <span class="s2">&quot;src,tests&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Comma-separated directories to include in proof&quot;</span>
    <span class="p">),</span>
    <span class="n">skip_tests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Skip running tests (debugging only)&quot;</span><span class="p">),</span>
    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="s2">&quot;uv run pytest&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Command to run tests&quot;</span><span class="p">),</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Test timeout in seconds&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a cryptographic proof of the codebase (Code Merkle Tree) and binds it to test results.</span>
<span class="sd">    Does NOT seal the MRP (that happens after manual summary).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">root_dir</span> <span class="o">=</span> <span class="n">ensure_geas_root</span><span class="p">()</span>
        <span class="n">bolt_id</span> <span class="o">=</span> <span class="n">get_active_bolt_name</span><span class="p">()</span>

        <span class="c1"># 1. State Check: Is SEAL_INTENT present?</span>
        <span class="n">bolt_path</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">/</span> <span class="s2">&quot;.geas&quot;</span> <span class="o">/</span> <span class="s2">&quot;bolts&quot;</span> <span class="o">/</span> <span class="n">bolt_id</span>
        <span class="n">ledger</span> <span class="o">=</span> <span class="n">LedgerManager</span><span class="o">.</span><span class="n">load_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ledger</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Ledger not found for bolt &#39;[cyan]</span><span class="si">{</span><span class="n">bolt_id</span><span class="si">}</span><span class="s2">[/cyan]&#39;.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">has_sealed_intent</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;SEAL_INTENT&quot;</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">has_sealed_intent</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[bold red]Error:[/bold red] Intent not sealed for bolt &#39;[cyan]</span><span class="si">{</span><span class="n">bolt_id</span><span class="si">}</span><span class="s2">[/cyan]&#39;. Cannot proceed to Prove phase.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># 2. Testing</span>
        <span class="k">if</span> <span class="n">skip_tests</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[yellow]Skipping tests as requested.[/yellow]&quot;</span><span class="p">)</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">geas_ai.core.manifest</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestResultInfo</span>

            <span class="n">test_result</span> <span class="o">=</span> <span class="n">TestResultInfo</span><span class="p">(</span>
                <span class="n">passed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Tentatively true if skipped? Or should be marked specially?</span>
                <span class="c1"># Specs say &quot;Skip tests (Flag) For manual override/debugging&quot;.</span>
                <span class="n">exit_code</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">duration_seconds</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold blue]Running tests...[/bold blue] (</span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">test_result</span> <span class="o">=</span> <span class="n">run_tests</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">test_result</span><span class="o">.</span><span class="n">passed</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;[bold red]Tests Failed![/bold red] (Exit Code: </span><span class="si">{</span><span class="n">test_result</span><span class="o">.</span><span class="n">exit_code</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>
                <span class="c1"># We can write the log but we should exit and NOT generate manifest?</span>
                <span class="c1"># Specs: &quot;If fail -&gt; Exit.&quot;</span>
                <span class="c1"># But we might want to see the logs.</span>
                <span class="c1"># Let&#39;s write logs and exit.</span>
                <span class="c1"># Actually specs say: &quot;Output: Print success message...&quot;. Implicitly if fail, we assume we stop?</span>
                <span class="c1"># &quot;Scenario: Test Failure Abort ... manifest should not be created&quot;.</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[red]Aborting proof generation due to test failure.[/red]&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;[bold green]Tests Passed![/bold green] (</span><span class="si">{</span><span class="n">test_result</span><span class="o">.</span><span class="n">duration_seconds</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s)&quot;</span>
                <span class="p">)</span>

        <span class="c1"># 3. Manifesting</span>
        <span class="n">scope_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scope</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

        <span class="c1"># Check scope existence (warn if missing)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scope_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">root_dir</span> <span class="o">/</span> <span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[yellow]Warning:[/yellow] Scope directory &#39;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>

        <span class="n">files</span> <span class="o">=</span> <span class="n">walk_source_files</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="n">scope_list</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[bold red]Error:[/bold red] No files found in the specified scope.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hashing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files...&quot;</span><span class="p">)</span>
        <span class="n">file_hashes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">fpath</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">full_path</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">/</span> <span class="n">fpath</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">file_hashes</span><span class="p">[</span><span class="n">fpath</span><span class="p">]</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="n">manifest</span> <span class="o">=</span> <span class="n">generate_manifest</span><span class="p">(</span><span class="n">bolt_id</span><span class="p">,</span> <span class="n">scope_list</span><span class="p">,</span> <span class="n">file_hashes</span><span class="p">,</span> <span class="n">test_result</span><span class="p">)</span>

        <span class="c1"># 4. Artifact Generation</span>
        <span class="n">bolt_dir</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">/</span> <span class="s2">&quot;.geas&quot;</span> <span class="o">/</span> <span class="s2">&quot;bolts&quot;</span> <span class="o">/</span> <span class="n">bolt_id</span>
        <span class="n">mrp_dir</span> <span class="o">=</span> <span class="n">bolt_dir</span> <span class="o">/</span> <span class="s2">&quot;mrp&quot;</span>
        <span class="n">mrp_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">manifest_path</span> <span class="o">=</span> <span class="n">mrp_dir</span> <span class="o">/</span> <span class="s2">&quot;manifest.json&quot;</span>
        <span class="n">tests_log_path</span> <span class="o">=</span> <span class="n">mrp_dir</span> <span class="o">/</span> <span class="s2">&quot;tests.log&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">manifest_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">manifest</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

        <span class="c1"># Write a simple log file for tests (could be more detailed if we captured stdout)</span>
        <span class="c1"># run_tests returns a simple object. If we want full logs we&#39;d need to modify run_tests to return stdout.</span>
        <span class="c1"># The current run_tests implementation captures output but doesn&#39;t return it in the struct.</span>
        <span class="c1"># I should probably update run_tests to return output if I need to write it to tests.log.</span>
        <span class="c1"># For now I will just write the summary in tests.log as the specs define &quot;mrp/tests.log&quot; but not its content.</span>
        <span class="c1"># Wait, usually a log file contains the output.</span>
        <span class="c1"># I will update run_tests to include output in the model or return it separately?</span>
        <span class="c1"># The TestResultInfo model in the specs didn&#39;t have &#39;output&#39;.</span>
        <span class="c1"># I&#39;ll stick to what I have, maybe just writing the metadata to tests.log for now,</span>
        <span class="c1"># OR I should update `TestResultInfo` to include `output`.</span>
        <span class="c1"># Let&#39;s assume for now I should just log the result info.</span>
        <span class="c1"># Note: Ideally I would change TestResultInfo to include stdout/stderr.</span>
        <span class="c1"># Let&#39;s verify the `TestResultInfo` definition I created.</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tests_log_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Test Execution Log</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Timestamp: </span><span class="si">{</span><span class="n">test_result</span><span class="o">.</span><span class="n">timestamp</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command: </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Passed: </span><span class="si">{</span><span class="n">test_result</span><span class="o">.</span><span class="n">passed</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exit Code: </span><span class="si">{</span><span class="n">test_result</span><span class="o">.</span><span class="n">exit_code</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duration: </span><span class="si">{</span><span class="n">test_result</span><span class="o">.</span><span class="n">duration_seconds</span><span class="si">}</span><span class="s2">s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">test_result</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>

        <span class="c1"># 5. Output</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="n">Panel</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;[green]Proof Generated Successfully![/green]</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Manifest: [bold]</span><span class="si">{</span><span class="n">manifest_path</span><span class="si">}</span><span class="s2">[/bold]</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Root Hash: [cyan]</span><span class="si">{</span><span class="n">manifest</span><span class="o">.</span><span class="n">root_hash</span><span class="si">}</span><span class="s2">[/cyan]</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Next Steps:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;1. Review the proof artifacts in [bold]mrp/[/bold].</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;2. Write a qualitative report in [bold]mrp/summary.md[/bold].</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;3. Run [bold]geas seal mrp[/bold] to finalize.&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;GEAS Proof Engine&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[bold red]An unexpected error occurred:[/bold red] </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="core-logic">Core Logic</h2>


<div class="doc doc-object doc-module">



<h2 id="geas_ai.core.identity" class="doc doc-heading">
            <code>geas_ai.core.identity</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="geas_ai.core.identity.IdentityManager" class="doc doc-heading">
            <code>IdentityManager</code>


</h3>


    <div class="doc doc-contents ">



        <p>Manages reading and writing identities to identities.yaml.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/geas_ai/core/identity.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IdentityManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages reading and writing identities to identities.yaml.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">config_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span> <span class="o">=</span> <span class="n">config_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span> <span class="o">=</span> <span class="n">get_geas_root</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span> <span class="o">/</span> <span class="s2">&quot;identities.yaml&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaml</span> <span class="o">=</span> <span class="n">YAML</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">preserve_quotes</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IdentityStore</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads identities from the YAML file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="n">identities</span><span class="o">=</span><span class="p">[])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
                <span class="c1"># Handle empty file or null data</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="n">identities</span><span class="o">=</span><span class="p">[])</span>
                <span class="c1"># If data has &#39;identities&#39; key, use it. If list, wrap it?</span>
                <span class="c1"># Spec implies structure is: identities: [ ... ]</span>
                <span class="k">if</span> <span class="s2">&quot;identities&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="n">identities</span><span class="o">=</span><span class="p">[])</span>

                <span class="c1"># Convert raw dicts to Identity objects</span>
                <span class="c1"># Pydantic validation happens here</span>
                <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Maybe raise a custom error or return empty?</span>
            <span class="c1"># For now, let&#39;s propagate or raise helpful error</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load identities from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="n">IdentityStore</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the IdentityStore to the YAML file.&quot;&quot;&quot;</span>
        <span class="c1"># Ensure directory exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Dump to dict</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_identity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identity</span><span class="p">:</span> <span class="n">Identity</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a new identity and saves.&quot;&quot;&quot;</span>
        <span class="n">store</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
        <span class="c1"># Check uniqueness</span>
        <span class="k">if</span> <span class="n">store</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">identity</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Identity with name &#39;</span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists.&quot;</span><span class="p">)</span>

        <span class="n">store</span><span class="o">.</span><span class="n">identities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.identity.IdentityManager.add_identity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_identity</span><span class="p">(</span><span class="n">identity</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Adds a new identity and saves.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_identity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identity</span><span class="p">:</span> <span class="n">Identity</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a new identity and saves.&quot;&quot;&quot;</span>
    <span class="n">store</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="c1"># Check uniqueness</span>
    <span class="k">if</span> <span class="n">store</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">identity</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Identity with name &#39;</span><span class="si">{</span><span class="n">identity</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already exists.&quot;</span><span class="p">)</span>

    <span class="n">store</span><span class="o">.</span><span class="n">identities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.identity.IdentityManager.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Loads identities from the YAML file.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IdentityStore</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads identities from the YAML file.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="n">identities</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
            <span class="c1"># Handle empty file or null data</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="n">identities</span><span class="o">=</span><span class="p">[])</span>
            <span class="c1"># If data has &#39;identities&#39; key, use it. If list, wrap it?</span>
            <span class="c1"># Spec implies structure is: identities: [ ... ]</span>
            <span class="k">if</span> <span class="s2">&quot;identities&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="n">identities</span><span class="o">=</span><span class="p">[])</span>

            <span class="c1"># Convert raw dicts to Identity objects</span>
            <span class="c1"># Pydantic validation happens here</span>
            <span class="k">return</span> <span class="n">IdentityStore</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Maybe raise a custom error or return empty?</span>
        <span class="c1"># For now, let&#39;s propagate or raise helpful error</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load identities from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.identity.IdentityManager.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">store</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Saves the IdentityStore to the YAML file.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="n">IdentityStore</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves the IdentityStore to the YAML file.&quot;&quot;&quot;</span>
    <span class="c1"># Ensure directory exists</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Dump to dict</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="geas_ai.core.identity.KeyManager" class="doc doc-heading">
            <code>KeyManager</code>


</h3>


    <div class="doc doc-contents ">



        <p>Handles resolution and loading of private keys.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/geas_ai/core/identity.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KeyManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles resolution and loading of private keys.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_private_key</span><span class="p">(</span><span class="n">identity_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolves and loads the private key for the given identity name.</span>

<span class="sd">        Priority:</span>
<span class="sd">        1. Environment Variable: GEAS_KEY_{NAME} (Content: PEM or Base64)</span>
<span class="sd">        2. Local File: ~/.geas/keys/{name}.key</span>

<span class="sd">        Returns:</span>
<span class="sd">            Ed25519PrivateKey object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyNotFoundError: If no key is found.</span>
<span class="sd">            CryptoError: If the key is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate identity_name to prevent path traversal</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">sep</span> <span class="ow">in</span> <span class="n">identity_name</span> <span class="k">for</span> <span class="n">sep</span> <span class="ow">in</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">altsep</span><span class="p">]</span> <span class="k">if</span> <span class="n">sep</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid identity name: &#39;</span><span class="si">{</span><span class="n">identity_name</span><span class="si">}</span><span class="s2">&#39;. Must not contain path separators.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># 1. Environment Variable Check</span>
        <span class="n">env_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;GEAS_KEY_</span><span class="si">{</span><span class="n">identity_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">env_val</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">env_var_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env_val</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Handle Base64 encoded or direct PEM content</span>
                <span class="c1"># If it looks like PEM (starts with -----BEGIN), use as is</span>
                <span class="k">if</span> <span class="n">env_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-----BEGIN&quot;</span><span class="p">):</span>
                    <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">env_val</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Assume base64</span>
                    <span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

                    <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">env_val</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">load_private_key_from_bytes</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Fallthrough not implied by spec but good practice to log?</span>
                <span class="c1"># Spec says &quot;Decode value... Parse... Return&quot;. If fail, maybe raise?</span>
                <span class="c1"># Spec says &quot;Error State: Raise KeyNotFoundError&quot; if *not found*.</span>
                <span class="c1"># If found but invalid, CryptoError seems appropriate.</span>
                <span class="k">raise</span> <span class="n">CryptoError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid key in environment variable </span><span class="si">{</span><span class="n">env_var_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># 2. Local File Check</span>
        <span class="n">key_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;~/.geas/keys/</span><span class="si">{</span><span class="n">identity_name</span><span class="si">}</span><span class="s2">.key&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">key_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">key_path</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">load_private_key_from_bytes</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CryptoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid key in file </span><span class="si">{</span><span class="n">key_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># 3. Not Found</span>
        <span class="k">raise</span> <span class="n">KeyNotFoundError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Private key for &#39;</span><span class="si">{</span><span class="n">identity_name</span><span class="si">}</span><span class="s2">&#39; not found in env (</span><span class="si">{</span><span class="n">env_var_name</span><span class="si">}</span><span class="s2">) or local storage (</span><span class="si">{</span><span class="n">key_path</span><span class="si">}</span><span class="s2">).&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.identity.KeyManager.load_private_key" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_private_key</span><span class="p">(</span><span class="n">identity_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Resolves and loads the private key for the given identity name.</p>
<p>Priority:
1. Environment Variable: GEAS_KEY_{NAME} (Content: PEM or Base64)
2. Local File: ~/.geas/keys/{name}.key</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ed25519PrivateKey object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="KeyNotFoundError (geas_ai.core.identity.KeyNotFoundError)" href="#geas_ai.core.identity.KeyNotFoundError">KeyNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no key is found.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="geas_ai.utils.crypto.CryptoError">CryptoError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the key is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/identity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_private_key</span><span class="p">(</span><span class="n">identity_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resolves and loads the private key for the given identity name.</span>

<span class="sd">    Priority:</span>
<span class="sd">    1. Environment Variable: GEAS_KEY_{NAME} (Content: PEM or Base64)</span>
<span class="sd">    2. Local File: ~/.geas/keys/{name}.key</span>

<span class="sd">    Returns:</span>
<span class="sd">        Ed25519PrivateKey object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyNotFoundError: If no key is found.</span>
<span class="sd">        CryptoError: If the key is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate identity_name to prevent path traversal</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">sep</span> <span class="ow">in</span> <span class="n">identity_name</span> <span class="k">for</span> <span class="n">sep</span> <span class="ow">in</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">altsep</span><span class="p">]</span> <span class="k">if</span> <span class="n">sep</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid identity name: &#39;</span><span class="si">{</span><span class="n">identity_name</span><span class="si">}</span><span class="s2">&#39;. Must not contain path separators.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># 1. Environment Variable Check</span>
    <span class="n">env_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;GEAS_KEY_</span><span class="si">{</span><span class="n">identity_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">env_val</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">env_var_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">env_val</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Handle Base64 encoded or direct PEM content</span>
            <span class="c1"># If it looks like PEM (starts with -----BEGIN), use as is</span>
            <span class="k">if</span> <span class="n">env_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-----BEGIN&quot;</span><span class="p">):</span>
                <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">env_val</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Assume base64</span>
                <span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

                <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">env_val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">load_private_key_from_bytes</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Fallthrough not implied by spec but good practice to log?</span>
            <span class="c1"># Spec says &quot;Decode value... Parse... Return&quot;. If fail, maybe raise?</span>
            <span class="c1"># Spec says &quot;Error State: Raise KeyNotFoundError&quot; if *not found*.</span>
            <span class="c1"># If found but invalid, CryptoError seems appropriate.</span>
            <span class="k">raise</span> <span class="n">CryptoError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid key in environment variable </span><span class="si">{</span><span class="n">env_var_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="c1"># 2. Local File Check</span>
    <span class="n">key_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;~/.geas/keys/</span><span class="si">{</span><span class="n">identity_name</span><span class="si">}</span><span class="s2">.key&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">key_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">key_path</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">load_private_key_from_bytes</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CryptoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid key in file </span><span class="si">{</span><span class="n">key_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 3. Not Found</span>
    <span class="k">raise</span> <span class="n">KeyNotFoundError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Private key for &#39;</span><span class="si">{</span><span class="n">identity_name</span><span class="si">}</span><span class="s2">&#39; not found in env (</span><span class="si">{</span><span class="n">env_var_name</span><span class="si">}</span><span class="s2">) or local storage (</span><span class="si">{</span><span class="n">key_path</span><span class="si">}</span><span class="s2">).&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="geas_ai.core.identity.KeyNotFoundError" class="doc doc-heading">
            <code>KeyNotFoundError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>



        <p>Raised when a private key cannot be resolved.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/geas_ai/core/identity.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KeyNotFoundError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a private key cannot be resolved.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.core.ledger" class="doc doc-heading">
            <code>geas_ai.core.ledger</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="geas_ai.core.ledger.LedgerIntegrityError" class="doc doc-heading">
            <code>LedgerIntegrityError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>



        <p>Raised when ledger chain verification fails.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/geas_ai/core/ledger.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LedgerIntegrityError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when ledger chain verification fails.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="geas_ai.core.ledger.LedgerManager" class="doc doc-heading">
            <code>LedgerManager</code>


</h3>


    <div class="doc doc-contents ">



        <p>Manages lock.json operations.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/geas_ai/core/ledger.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LedgerManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages lock.json operations.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Ledger</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the ledger from lock.json if it exists.&quot;&quot;&quot;</span>
        <span class="n">lock_path</span> <span class="o">=</span> <span class="n">bolt_path</span> <span class="o">/</span> <span class="n">LOCK_FILE_NAME</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lock_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lock_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">Ledger</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># If load fails (e.g. empty or corrupted), we treat as None or raise</span>
            <span class="c1"># For now, let&#39;s raise to indicate corruption</span>
            <span class="k">raise</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">Ledger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the ledger to lock.json.&quot;&quot;&quot;</span>
        <span class="n">lock_path</span> <span class="o">=</span> <span class="n">bolt_path</span> <span class="o">/</span> <span class="n">LOCK_FILE_NAME</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lock_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_genesis_ledger</span><span class="p">(</span><span class="n">bolt_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Ledger</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new empty ledger.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Ledger</span><span class="p">(</span><span class="n">bolt_id</span><span class="o">=</span><span class="n">bolt_id</span><span class="p">,</span> <span class="n">created_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">(),</span> <span class="n">events</span><span class="o">=</span><span class="p">[])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_event</span><span class="p">(</span><span class="n">ledger</span><span class="p">:</span> <span class="n">Ledger</span><span class="p">,</span> <span class="n">event_data</span><span class="p">:</span> <span class="n">LedgerEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Ledger</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends a new event to the ledger.</span>
<span class="sd">        Updates sequence, prev_hash, and calculates event_hash.</span>
<span class="sd">        Note: The input event_data should have action, payload, identity set.</span>
<span class="sd">        Sequence, timestamp, prev_hash, event_hash will be handled here if not set correctly,</span>
<span class="sd">        but for strictness we expect caller to prepare most of it,</span>
<span class="sd">        EXCEPT hashing and linking which MUST be done here to ensure consistency.</span>

<span class="sd">        However, to simplify usage: we will take a partially constructed event</span>
<span class="sd">        or arguments and build the final event here.</span>

<span class="sd">        Let&#39;s assume the caller constructs a LedgerEvent BUT we override</span>
<span class="sd">        sequence, prev_hash, and event_hash to ensure integrity.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># 1. Determine Sequence</span>
        <span class="n">new_sequence</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="c1"># 2. Get Prev Hash</span>
        <span class="n">prev_hash</span> <span class="o">=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">head_hash</span>

        <span class="c1"># 3. Update Event fields</span>
        <span class="n">event_data</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="n">new_sequence</span>
        <span class="n">event_data</span><span class="o">.</span><span class="n">prev_hash</span> <span class="o">=</span> <span class="n">prev_hash</span>

        <span class="c1"># 4. Calculate Event Hash</span>
        <span class="c1"># Convert to dict, exclude &#39;event_hash&#39; for calculation</span>
        <span class="n">event_dict</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;event_hash&quot;</span> <span class="ow">in</span> <span class="n">event_dict</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">event_dict</span><span class="p">[</span><span class="s2">&quot;event_hash&quot;</span><span class="p">]</span>

        <span class="n">event_hash</span> <span class="o">=</span> <span class="n">calculate_event_hash</span><span class="p">(</span><span class="n">event_dict</span><span class="p">)</span>
        <span class="n">event_data</span><span class="o">.</span><span class="n">event_hash</span> <span class="o">=</span> <span class="n">event_hash</span>

        <span class="c1"># 5. Append and Update Head</span>
        <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_data</span><span class="p">)</span>
        <span class="n">ledger</span><span class="o">.</span><span class="n">head_hash</span> <span class="o">=</span> <span class="n">event_hash</span>

        <span class="k">return</span> <span class="n">ledger</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_chain_integrity</span><span class="p">(</span><span class="n">ledger</span><span class="p">:</span> <span class="n">Ledger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies the hash chain integrity of the ledger.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_prev_hash</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">):</span>
            <span class="c1"># Check sequence</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">sequence</span> <span class="o">!=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># Check prev_hash linking</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">prev_hash</span> <span class="o">!=</span> <span class="n">current_prev_hash</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># Check event hash</span>
            <span class="n">event_dict</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;event_hash&quot;</span> <span class="ow">in</span> <span class="n">event_dict</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">event_dict</span><span class="p">[</span><span class="s2">&quot;event_hash&quot;</span><span class="p">]</span>

            <span class="n">calculated_hash</span> <span class="o">=</span> <span class="n">calculate_event_hash</span><span class="p">(</span><span class="n">event_dict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">calculated_hash</span> <span class="o">!=</span> <span class="n">event</span><span class="o">.</span><span class="n">event_hash</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">current_prev_hash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">event_hash</span>

        <span class="c1"># Check head hash matches last event</span>
        <span class="k">if</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span> <span class="ow">and</span> <span class="n">ledger</span><span class="o">.</span><span class="n">head_hash</span> <span class="o">!=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">event_hash</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.ledger.LedgerManager.append_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append_event</span><span class="p">(</span><span class="n">ledger</span><span class="p">,</span> <span class="n">event_data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Appends a new event to the ledger.
Updates sequence, prev_hash, and calculates event_hash.
Note: The input event_data should have action, payload, identity set.
Sequence, timestamp, prev_hash, event_hash will be handled here if not set correctly,
but for strictness we expect caller to prepare most of it,
EXCEPT hashing and linking which MUST be done here to ensure consistency.</p>
<p>However, to simplify usage: we will take a partially constructed event
or arguments and build the final event here.</p>
<p>Let's assume the caller constructs a LedgerEvent BUT we override
sequence, prev_hash, and event_hash to ensure integrity.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/ledger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">append_event</span><span class="p">(</span><span class="n">ledger</span><span class="p">:</span> <span class="n">Ledger</span><span class="p">,</span> <span class="n">event_data</span><span class="p">:</span> <span class="n">LedgerEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Ledger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Appends a new event to the ledger.</span>
<span class="sd">    Updates sequence, prev_hash, and calculates event_hash.</span>
<span class="sd">    Note: The input event_data should have action, payload, identity set.</span>
<span class="sd">    Sequence, timestamp, prev_hash, event_hash will be handled here if not set correctly,</span>
<span class="sd">    but for strictness we expect caller to prepare most of it,</span>
<span class="sd">    EXCEPT hashing and linking which MUST be done here to ensure consistency.</span>

<span class="sd">    However, to simplify usage: we will take a partially constructed event</span>
<span class="sd">    or arguments and build the final event here.</span>

<span class="sd">    Let&#39;s assume the caller constructs a LedgerEvent BUT we override</span>
<span class="sd">    sequence, prev_hash, and event_hash to ensure integrity.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># 1. Determine Sequence</span>
    <span class="n">new_sequence</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># 2. Get Prev Hash</span>
    <span class="n">prev_hash</span> <span class="o">=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">head_hash</span>

    <span class="c1"># 3. Update Event fields</span>
    <span class="n">event_data</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="n">new_sequence</span>
    <span class="n">event_data</span><span class="o">.</span><span class="n">prev_hash</span> <span class="o">=</span> <span class="n">prev_hash</span>

    <span class="c1"># 4. Calculate Event Hash</span>
    <span class="c1"># Convert to dict, exclude &#39;event_hash&#39; for calculation</span>
    <span class="n">event_dict</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;event_hash&quot;</span> <span class="ow">in</span> <span class="n">event_dict</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">event_dict</span><span class="p">[</span><span class="s2">&quot;event_hash&quot;</span><span class="p">]</span>

    <span class="n">event_hash</span> <span class="o">=</span> <span class="n">calculate_event_hash</span><span class="p">(</span><span class="n">event_dict</span><span class="p">)</span>
    <span class="n">event_data</span><span class="o">.</span><span class="n">event_hash</span> <span class="o">=</span> <span class="n">event_hash</span>

    <span class="c1"># 5. Append and Update Head</span>
    <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_data</span><span class="p">)</span>
    <span class="n">ledger</span><span class="o">.</span><span class="n">head_hash</span> <span class="o">=</span> <span class="n">event_hash</span>

    <span class="k">return</span> <span class="n">ledger</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.ledger.LedgerManager.create_genesis_ledger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_genesis_ledger</span><span class="p">(</span><span class="n">bolt_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Creates a new empty ledger.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/ledger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_genesis_ledger</span><span class="p">(</span><span class="n">bolt_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Ledger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new empty ledger.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Ledger</span><span class="p">(</span><span class="n">bolt_id</span><span class="o">=</span><span class="n">bolt_id</span><span class="p">,</span> <span class="n">created_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">(),</span> <span class="n">events</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.ledger.LedgerManager.load_lock" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Loads the ledger from lock.json if it exists.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/ledger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Ledger</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads the ledger from lock.json if it exists.&quot;&quot;&quot;</span>
    <span class="n">lock_path</span> <span class="o">=</span> <span class="n">bolt_path</span> <span class="o">/</span> <span class="n">LOCK_FILE_NAME</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">lock_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lock_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Ledger</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># If load fails (e.g. empty or corrupted), we treat as None or raise</span>
        <span class="c1"># For now, let&#39;s raise to indicate corruption</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.ledger.LedgerManager.save_lock" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">,</span> <span class="n">ledger</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Saves the ledger to lock.json.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/ledger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">save_lock</span><span class="p">(</span><span class="n">bolt_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">Ledger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves the ledger to lock.json.&quot;&quot;&quot;</span>
    <span class="n">lock_path</span> <span class="o">=</span> <span class="n">bolt_path</span> <span class="o">/</span> <span class="n">LOCK_FILE_NAME</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">lock_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.ledger.LedgerManager.verify_chain_integrity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">verify_chain_integrity</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Verifies the hash chain integrity of the ledger.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/ledger.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">verify_chain_integrity</span><span class="p">(</span><span class="n">ledger</span><span class="p">:</span> <span class="n">Ledger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verifies the hash chain integrity of the ledger.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_prev_hash</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">):</span>
        <span class="c1"># Check sequence</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">sequence</span> <span class="o">!=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check prev_hash linking</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">prev_hash</span> <span class="o">!=</span> <span class="n">current_prev_hash</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check event hash</span>
        <span class="n">event_dict</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;event_hash&quot;</span> <span class="ow">in</span> <span class="n">event_dict</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">event_dict</span><span class="p">[</span><span class="s2">&quot;event_hash&quot;</span><span class="p">]</span>

        <span class="n">calculated_hash</span> <span class="o">=</span> <span class="n">calculate_event_hash</span><span class="p">(</span><span class="n">event_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">calculated_hash</span> <span class="o">!=</span> <span class="n">event</span><span class="o">.</span><span class="n">event_hash</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">current_prev_hash</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">event_hash</span>

    <span class="c1"># Check head hash matches last event</span>
    <span class="k">if</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span> <span class="ow">and</span> <span class="n">ledger</span><span class="o">.</span><span class="n">head_hash</span> <span class="o">!=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">events</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">event_hash</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.core.workflow" class="doc doc-heading">
            <code>geas_ai.core.workflow</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="geas_ai.core.workflow.WorkflowManager" class="doc doc-heading">
            <code>WorkflowManager</code>


</h3>


    <div class="doc doc-contents ">



        <p>Manages workflow configuration loading and validation.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/geas_ai/core/workflow.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WorkflowManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages workflow configuration loading and validation.&quot;&quot;&quot;</span>

    <span class="n">DEFAULT_WORKFLOW</span> <span class="o">=</span> <span class="n">WorkflowConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;standard_dev&quot;</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
        <span class="n">intent_documents</span><span class="o">=</span><span class="n">IntentConfig</span><span class="p">(</span>
            <span class="n">required</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;01_request.md&quot;</span><span class="p">,</span> <span class="s2">&quot;02_specs.md&quot;</span><span class="p">],</span> <span class="n">optional</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;03_plan.md&quot;</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="n">stages</span><span class="o">=</span><span class="p">[</span>
            <span class="n">WorkflowStage</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;req&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;SEAL_REQ&quot;</span><span class="p">,</span>
                <span class="n">required_role</span><span class="o">=</span><span class="s2">&quot;human&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Seal Requirements&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">WorkflowStage</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;specs&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;SEAL_SPECS&quot;</span><span class="p">,</span>
                <span class="n">required_role</span><span class="o">=</span><span class="s2">&quot;human&quot;</span><span class="p">,</span>
                <span class="n">prerequisite</span><span class="o">=</span><span class="s2">&quot;req&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Seal Specifications&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">WorkflowStage</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;plan&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;SEAL_PLAN&quot;</span><span class="p">,</span>
                <span class="n">required_role</span><span class="o">=</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span>
                <span class="n">prerequisite</span><span class="o">=</span><span class="s2">&quot;specs&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Seal Implementation Plan&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">WorkflowStage</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;intent&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;SEAL_INTENT&quot;</span><span class="p">,</span>
                <span class="n">required_role</span><span class="o">=</span><span class="s2">&quot;human&quot;</span><span class="p">,</span>
                <span class="n">prerequisite</span><span class="o">=</span><span class="s2">&quot;plan&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Seal Intent (Req + Specs + Plan)&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">WorkflowStage</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;mrp&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;SEAL_MRP&quot;</span><span class="p">,</span>
                <span class="n">required_role</span><span class="o">=</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span>
                <span class="n">prerequisite</span><span class="o">=</span><span class="s2">&quot;intent&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Seal Merge Request Package&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">WorkflowStage</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;approve&quot;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s2">&quot;APPROVE&quot;</span><span class="p">,</span>
                <span class="n">required_role</span><span class="o">=</span><span class="s2">&quot;human&quot;</span><span class="p">,</span>
                <span class="n">prerequisite</span><span class="o">=</span><span class="s2">&quot;mrp&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Approve for Merge&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_workflow</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkflowConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the workflow configuration.</span>
<span class="sd">        Returns hardcoded default if file is missing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">config_path</span> <span class="ow">and</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="c1"># Use &#39;safe&#39; loading to prevent arbitrary code execution from untrusted configs</span>
            <span class="n">yaml</span> <span class="o">=</span> <span class="n">YAML</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s2">&quot;safe&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">WorkflowConfig</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># Log warning? For now fallback.</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">WorkflowManager</span><span class="o">.</span><span class="n">DEFAULT_WORKFLOW</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="geas_ai.core.workflow.WorkflowManager.load_workflow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_workflow</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Loads the workflow configuration.
Returns hardcoded default if file is missing.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_workflow</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkflowConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads the workflow configuration.</span>
<span class="sd">    Returns hardcoded default if file is missing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">config_path</span> <span class="ow">and</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="c1"># Use &#39;safe&#39; loading to prevent arbitrary code execution from untrusted configs</span>
        <span class="n">yaml</span> <span class="o">=</span> <span class="n">YAML</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s2">&quot;safe&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">WorkflowConfig</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># Log warning? For now fallback.</span>
            <span class="k">pass</span>

    <span class="k">return</span> <span class="n">WorkflowManager</span><span class="o">.</span><span class="n">DEFAULT_WORKFLOW</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.core.hashing" class="doc doc-heading">
            <code>geas_ai.core.hashing</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.core.hashing.calculate_event_hash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_event_hash</span><span class="p">(</span><span class="n">event_data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the SHA-256 hash of a ledger event.</p>
<p>The event dictionary should exclude the 'event_hash' field itself
before calling this function if it was already present.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/hashing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_event_hash</span><span class="p">(</span><span class="n">event_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the SHA-256 hash of a ledger event.</span>

<span class="sd">    The event dictionary should exclude the &#39;event_hash&#39; field itself</span>
<span class="sd">    before calling this function if it was already present.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">canonical_bytes</span> <span class="o">=</span> <span class="n">canonicalize_json</span><span class="p">(</span><span class="n">event_data</span><span class="p">)</span>
    <span class="n">sha256_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">canonical_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;sha256:</span><span class="si">{</span><span class="n">sha256_hash</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.core.hashing.file_sha256" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_sha256</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes SHA256 hash of the file content (normalized to UTF-8 text if possible).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/hashing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">file_sha256</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes SHA256 hash of the file content (normalized to UTF-8 text if possible).&quot;&quot;&quot;</span>
    <span class="n">sha256</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Read in chunks to be memory efficient</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4096</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="n">sha256</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;sha256:</span><span class="si">{</span><span class="n">sha256</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.core.manifest" class="doc doc-heading">
            <code>geas_ai.core.manifest</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.core.manifest.calculate_merkle_root" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_merkle_root</span><span class="p">(</span><span class="n">files</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the Merkle Root from a dictionary of file paths and their SHA256 hashes.</p>
<p>Logic:
1. Leaves: Sort filepaths -&gt; Extract hashes.
2. Leaf Hashing: We use the hash provided in the dict (SHA256 of content).
3. Tree Construction:
    - Pair adjacent nodes (A, B).
    - Parent = SHA256(A + B).
    - If odd count, Parent = SHA256(Last + Last).
    - Repeat until Root.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/manifest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_merkle_root</span><span class="p">(</span><span class="n">files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Merkle Root from a dictionary of file paths and their SHA256 hashes.</span>

<span class="sd">    Logic:</span>
<span class="sd">    1. Leaves: Sort filepaths -&gt; Extract hashes.</span>
<span class="sd">    2. Leaf Hashing: We use the hash provided in the dict (SHA256 of content).</span>
<span class="sd">    3. Tree Construction:</span>
<span class="sd">        - Pair adjacent nodes (A, B).</span>
<span class="sd">        - Parent = SHA256(A + B).</span>
<span class="sd">        - If odd count, Parent = SHA256(Last + Last).</span>
<span class="sd">        - Repeat until Root.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
        <span class="c1"># Return hash of empty string if no files</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="c1"># Sort by filepath to ensure deterministic ordering</span>
    <span class="n">sorted_paths</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="c1"># Extract hashes</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">files</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">sorted_paths</span><span class="p">]</span>

    <span class="n">current_level</span> <span class="o">=</span> <span class="n">leaves</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_level</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">next_level</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_level</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">current_level</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_level</span><span class="p">):</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">current_level</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Odd count, duplicate last</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">left</span>

            <span class="c1"># Combine hashes and hash again</span>
            <span class="n">combined</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">parent_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
            <span class="n">next_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_hash</span><span class="p">)</span>
        <span class="n">current_level</span> <span class="o">=</span> <span class="n">next_level</span>

    <span class="k">return</span> <span class="n">current_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.core.manifest.generate_manifest" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_manifest</span><span class="p">(</span><span class="n">bolt_id</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">test_result</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates the Manifest object.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/manifest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_manifest</span><span class="p">(</span>
    <span class="n">bolt_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">test_result</span><span class="p">:</span> <span class="n">TestResultInfo</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Manifest</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates the Manifest object.&quot;&quot;&quot;</span>
    <span class="n">root_hash</span> <span class="o">=</span> <span class="n">calculate_merkle_root</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Manifest</span><span class="p">(</span>
        <span class="n">bolt_id</span><span class="o">=</span><span class="n">bolt_id</span><span class="p">,</span>
        <span class="n">generated_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
        <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">,</span>
        <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
        <span class="n">root_hash</span><span class="o">=</span><span class="n">root_hash</span><span class="p">,</span>
        <span class="n">test_result</span><span class="o">=</span><span class="n">test_result</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.core.walker" class="doc doc-heading">
            <code>geas_ai.core.walker</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.core.walker.load_gitignore_patterns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_gitignore_patterns</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Loads .gitignore patterns from the root directory if it exists.
Always includes default ignore patterns for .geas, <strong>pycache</strong>, and .git.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/walker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_gitignore_patterns</span><span class="p">(</span><span class="n">root_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathspec</span><span class="o">.</span><span class="n">PathSpec</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads .gitignore patterns from the root directory if it exists.</span>
<span class="sd">    Always includes default ignore patterns for .geas, __pycache__, and .git.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gitignore_path</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">/</span> <span class="s2">&quot;.gitignore&quot;</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Always ignore these</span>
    <span class="n">default_ignores</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;.geas/&quot;</span><span class="p">,</span> <span class="s2">&quot;__pycache__/&quot;</span><span class="p">,</span> <span class="s2">&quot;.git/&quot;</span><span class="p">,</span> <span class="s2">&quot;*.pyc&quot;</span><span class="p">]</span>
    <span class="n">patterns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">default_ignores</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gitignore_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">gitignore_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">patterns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">pathspec</span><span class="o">.</span><span class="n">PathSpec</span><span class="o">.</span><span class="n">from_lines</span><span class="p">(</span><span class="s2">&quot;gitwildmatch&quot;</span><span class="p">,</span> <span class="n">patterns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="geas_ai.core.walker.walk_source_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">walk_source_files</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="n">scope_dirs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Recursively walks the specified scope directories, filtering files based on .gitignore
and default ignore patterns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>root_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The root directory of the project.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scope_dirs</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of directory names (relative to root) to include in the walk.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of file paths relative to root_dir.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/walker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">walk_source_files</span><span class="p">(</span><span class="n">root_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">scope_dirs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively walks the specified scope directories, filtering files based on .gitignore</span>
<span class="sd">    and default ignore patterns.</span>

<span class="sd">    Args:</span>
<span class="sd">        root_dir: The root directory of the project.</span>
<span class="sd">        scope_dirs: List of directory names (relative to root) to include in the walk.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of file paths relative to root_dir.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">load_gitignore_patterns</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span>
    <span class="n">collected_files</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1"># Ensure scope directories exist</span>
    <span class="n">valid_scope_dirs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">scope_dirs</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">/</span> <span class="n">d</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">valid_scope_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="c1"># We silently skip missing directories as per previous discussion (&quot;just raise a warning&quot; handled by caller or implied here)</span>
        <span class="c1"># Actually, the user said &quot;just raise a warning&quot; for missing scope.</span>
        <span class="c1"># I will let the caller handle warnings if needed, here I just walk what exists.</span>

    <span class="k">for</span> <span class="n">scope_dir</span> <span class="ow">in</span> <span class="n">valid_scope_dirs</span><span class="p">:</span>
        <span class="c1"># Walk logic</span>
        <span class="n">base_path</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">/</span> <span class="n">scope_dir</span>

        <span class="c1"># We walk everything under the scope_dir</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">base_path</span><span class="p">):</span>
            <span class="c1"># Calculate relative path from project root for filtering</span>
            <span class="n">rel_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span>

            <span class="c1"># Filter directories to prevent traversing into ignored ones</span>
            <span class="c1"># pathspec.match_file returns True if it matches an ignore pattern</span>
            <span class="c1"># We need to modify &#39;dirs&#39; in-place to prune the walk</span>

            <span class="c1"># Filter dirs</span>
            <span class="c1"># We must check each dir against the spec.</span>
            <span class="c1"># The spec expects paths relative to the root of the gitignore context (project root)</span>
            <span class="n">dirs</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">d</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">match_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rel_root</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
                <span class="c1"># appending &quot;/&quot; helps pathspec identify it as directory if the pattern ends with /</span>
            <span class="p">]</span>

            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">file_rel_path</span> <span class="o">=</span> <span class="n">rel_root</span> <span class="o">/</span> <span class="n">file</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">match_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_rel_path</span><span class="p">)):</span>
                    <span class="n">collected_files</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_rel_path</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">collected_files</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.core.testing" class="doc doc-heading">
            <code>geas_ai.core.testing</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="geas_ai.core.testing.run_tests" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_tests</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s1">&#39;uv run pytest&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Executes the test command and captures the result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The shell command to run tests.</p>
              </div>
            </td>
            <td>
                  <code>&#39;uv run pytest&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum execution time in seconds.</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="geas_ai.core.manifest.TestResultInfo">TestResultInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TestResultInfo object containing execution details.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/geas_ai/core/testing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_tests</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;uv run pytest&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestResultInfo</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes the test command and captures the result.</span>

<span class="sd">    Args:</span>
<span class="sd">        command: The shell command to run tests.</span>
<span class="sd">        timeout: Maximum execution time in seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TestResultInfo object containing execution details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Run the command</span>
        <span class="c1"># using shlex.split to properly parse command arguments</span>
        <span class="c1"># capture_output=True captures stdout and stderr</span>
        <span class="c1"># text=True decodes output as string</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">command</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">passed</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">TestResultInfo</span><span class="p">(</span>
            <span class="n">passed</span><span class="o">=</span><span class="n">passed</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">returncode</span><span class="p">,</span>
            <span class="n">duration_seconds</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
            <span class="n">output</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="c1"># Use errors=&quot;replace&quot; to prevent crash on non-utf8 output</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">stdout</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">stderr</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Timeout expired after </span><span class="si">{</span><span class="n">timeout</span><span class="si">}</span><span class="s2"> seconds.&quot;</span>
        <span class="k">return</span> <span class="n">TestResultInfo</span><span class="p">(</span>
            <span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="mi">124</span><span class="p">,</span>  <span class="c1"># Standard timeout exit code</span>
            <span class="n">duration_seconds</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
            <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Fallback for other errors (e.g. command not found)</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">TestResultInfo</span><span class="p">(</span>
            <span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">duration_seconds</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span>
            <span class="n">output</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="schemas">Schemas</h2>


<div class="doc doc-object doc-module">



<h2 id="geas_ai.schemas.identity" class="doc doc-heading">
            <code>geas_ai.schemas.identity</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.schemas.ledger" class="doc doc-heading">
            <code>geas_ai.schemas.ledger</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="geas_ai.schemas.workflow" class="doc doc-heading">
            <code>geas_ai.schemas.workflow</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">












  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>